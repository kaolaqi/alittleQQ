webpackJsonp([0],{326:function(e,n,t){function o(e){t(372)}var a=t(17)(t(352),t(385),o,"data-v-28c4c958",null);e.exports=a.exports},331:function(e,n,t){e.exports={default:t(333),__esModule:!0}},332:function(e,n,t){"use strict";n.__esModule=!0;var o=t(331),a=function(e){return e&&e.__esModule?e:{default:e}}(o);n.default=a.default||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}},333:function(e,n,t){t(337),e.exports=t(18).Object.assign},334:function(e,n,t){"use strict";var o=t(135),a=t(335),i=t(336),r=t(68),s=t(134),A=Object.assign;e.exports=!A||t(67)(function(){var e={},n={},t=Symbol(),o="abcdefghijklmnopqrst";return e[t]=7,o.split("").forEach(function(e){n[e]=e}),7!=A({},e)[t]||Object.keys(A({},n)).join("")!=o})?function(e,n){for(var t=r(e),A=arguments.length,c=1,d=a.f,l=i.f;A>c;)for(var h,u=s(arguments[c++]),f=d?o(u).concat(d(u)):o(u),g=f.length,C=0;g>C;)l.call(u,h=f[C++])&&(t[h]=u[h]);return t}:A},335:function(e,n){n.f=Object.getOwnPropertySymbols},336:function(e,n){n.f={}.propertyIsEnumerable},337:function(e,n,t){var o=t(27);o(o.S+o.F,"Object",{assign:t(334)})},338:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"NavHead",props:["title","ongHistoryBack","isBack","customBtn","onClickCustom","whiteColor","noShadow","avatar","icon"],data:function(){return{}},methods:{onBacK:function(){if(this.ongHistoryBack)return this.ongHistoryBack(),!1;this.$router.go(-1)},onCustom:function(){this.onClickCustom&&this.onClickCustom()},center:function(){console.log("个人中心侧栏")}}}},339:function(e,n,t){n=e.exports=t(320)(!0),n.push([e.i,".nav-head-container{position:fixed;top:0;left:0;right:0;line-height:.88rem;height:.88rem;text-align:center;background-color:#fff;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;color:#333;display:block;z-index:10;-webkit-box-shadow:0 3px 6px 0 hsla(0,0%,62%,.1);box-shadow:0 3px 6px 0 hsla(0,0%,62%,.1)}.nav-head-container.blue{background-color:#0ef9e0}.nav-head-container .nav-head-back-btn{margin-left:.35rem;float:left;z-index:15;position:relative}.nav-head-container .nav-head-back-btn i{position:relative;top:.14rem}.nav-head-container .nav-head-back-btn img{width:.5rem;border-radius:50%;border:1px solid #ccc;vertical-align:middle}.nav-head-container .nav-head-custom-btn{position:relative;float:right;margin-right:.34rem;line-height:.88rem;height:.88rem;z-index:15;color:#343643;font-size:.28rem}.nav-head-container .nav-head-custom-btn i{font-size:22px;vertical-align:middle}.nav-head-container .nav-head-title{position:absolute;left:0;right:0;text-align:center;color:#343643;line-height:.88rem;height:.88rem;z-index:10;font-size:.36rem}.nav-head-container .nav-head-title.no-shadow{-webkit-box-shadow:none;box-shadow:none}.nav-head-container.white{background-color:transparent}.nav-head-container.white .nav-head-custom-btn,.nav-head-container.white .nav-head-title{color:#fff}","",{version:3,sources:["/Users/kaolaqilee/Documents/projectDemo/alittleQQ/src/component/common/navHead/index.vue"],names:[],mappings:"AACA,oBACE,eAAgB,AAChB,MAAO,AACP,OAAU,AACV,QAAW,AACX,mBAAqB,AACrB,cAAgB,AAChB,kBAAmB,AACnB,sBAAuB,AACvB,8BAA+B,AACvB,sBAAuB,AAC/B,gBAAiB,AACjB,WAAY,AACZ,cAAe,AACf,WAAY,AACZ,iDAA6D,AACrD,wCAAqD,CAC9D,AACD,yBACI,wBAA0B,CAC7B,AACD,uCACI,mBAAqB,AACrB,WAAY,AACZ,WAAY,AACZ,iBAAmB,CACtB,AACD,yCACM,kBAAmB,AACnB,UAAa,CAClB,AACD,2CAEM,YAAc,AACd,kBAAmB,AACnB,sBAAuB,AACvB,qBAAuB,CAC5B,AACD,yCACI,kBAAmB,AACnB,YAAa,AACb,oBAAsB,AACtB,mBAAqB,AACrB,cAAgB,AAChB,WAAY,AACZ,cAAe,AACf,gBAAmB,CACtB,AACD,2CACM,eAAgB,AAChB,qBAAuB,CAC5B,AACD,oCACI,kBAAmB,AACnB,OAAU,AACV,QAAW,AACX,kBAAmB,AACnB,cAAe,AACf,mBAAqB,AACrB,cAAgB,AAChB,WAAY,AACZ,gBAAmB,CACtB,AACD,8CACM,wBAAyB,AACjB,eAAiB,CAC9B,AACD,0BACI,4BAA8B,CACjC,AACD,yFAEM,UAAY,CACjB",file:"index.vue",sourcesContent:["\n.nav-head-container {\n  position: fixed;\n  top: 0;\n  left: 0px;\n  right: 0px;\n  line-height: 0.88rem;\n  height: 0.88rem;\n  text-align: center;\n  background-color: #fff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  overflow: hidden;\n  color: #333;\n  display: block;\n  z-index: 10;\n  -webkit-box-shadow: 0px 3px 6px 0px rgba(158, 158, 158, 0.1);\n          box-shadow: 0px 3px 6px 0px rgba(158, 158, 158, 0.1);\n}\n.nav-head-container.blue {\n    background-color: #0ef9e0;\n}\n.nav-head-container .nav-head-back-btn {\n    margin-left: 0.35rem;\n    float: left;\n    z-index: 15;\n    position: relative;\n}\n.nav-head-container .nav-head-back-btn i {\n      position: relative;\n      top: 0.14rem;\n}\n.nav-head-container .nav-head-back-btn img {\n      width: 0.5rem;\n      width: 0.5rem;\n      border-radius: 50%;\n      border: 1px solid #ccc;\n      vertical-align: middle;\n}\n.nav-head-container .nav-head-custom-btn {\n    position: relative;\n    float: right;\n    margin-right: 0.34rem;\n    line-height: 0.88rem;\n    height: 0.88rem;\n    z-index: 15;\n    color: #343643;\n    font-size: 0.28rem;\n}\n.nav-head-container .nav-head-custom-btn i {\n      font-size: 22px;\n      vertical-align: middle;\n}\n.nav-head-container .nav-head-title {\n    position: absolute;\n    left: 0px;\n    right: 0px;\n    text-align: center;\n    color: #343643;\n    line-height: 0.88rem;\n    height: 0.88rem;\n    z-index: 10;\n    font-size: 0.36rem;\n}\n.nav-head-container .nav-head-title.no-shadow {\n      -webkit-box-shadow: none;\n              box-shadow: none;\n}\n.nav-head-container.white {\n    background-color: transparent;\n}\n.nav-head-container.white .nav-head-title,\n    .nav-head-container.white .nav-head-custom-btn {\n      color: #fff;\n}\n"],sourceRoot:""}])},340:function(e,n,t){var o=t(339);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(321)("10c359e6",o,!0)},341:function(e,n,t){function o(e){t(340)}var a=t(17)(t(338),t(342),o,null,null);e.exports=a.exports},342:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"nav-head-container",class:{white:e.whiteColor}},[e.isBack?t("div",{staticClass:"nav-head-back-btn common-clear-fixed",on:{click:e.onBacK}},[t("i",{staticClass:"cicon",class:{"icon-return":!e.whiteColor,"icon-return_white":e.whiteColor}})]):e._e(),e._v(" "),e.avatar?t("div",{staticClass:"nav-head-back-btn common-clear-fixed",on:{click:e.center}},[t("img",{attrs:{src:e.avatar}})]):e._e(),e._v(" "),t("div",{staticClass:"nav-head-title common-clear-fixed",class:{"no-shadow":e.noShadow}},[e._v(e._s(e.title))]),e._v(" "),e.customBtn?t("div",{staticClass:"nav-head-custom-btn common-clear-fixed",on:{click:e.onCustom}},[e._v(e._s(e.customBtn))]):e._e(),e._v(" "),e.icon?t("div",{staticClass:"nav-head-custom-btn common-clear-fixed",on:{click:e.onCustom}},[t("van-icon",{attrs:{name:e.icon}})],1):e._e()])},staticRenderFns:[]}},352:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(137),a=t.n(o),i=t(332),r=t.n(i),s=t(136),A=t(66),c=t(359),d=t(341),l=t.n(d),h=t(382),u=t.n(h);n.default={name:"MessageIndex",components:{navHead:l.a,footerChatInput:u.a},data:function(){return{friendInfo:{},messageRecords:[],wsInstance:null,setChatStatusFlag:!0,isLoading:!1,page:1}},computed:r()({},t.i(s.b)(["avatar","userId"])),created:function(){this.getFriendInfo()},mounted:function(){this.initWebSocket()},methods:{initWebSocket:function(){var e=this,n=this;this.wsInstance=new WebSocket(c.a+"/websocket/id"+n.userId),this.wsInstance.onopen=function(){console.log("userId为 "+n.userId+" 的用户链接到websocket服务")},this.wsInstance.onmessage=function(n){console.log("服务端推送回来的消息",n.data),e.messageRecords.push(JSON.parse(n.data)),console.log(e.$refs.messageList)},this.wsInstance.onclose=function(e){console.log("userId为 "+n.userId+" 的用户断开websocket链接")}},getFriendInfo:function(){var e=this;A.a.getUserInfo({mobile:this.$route.params.mobile}).then(function(n){200===n.statusCode&&(e.friendInfo=n.data,e.queryFriendMessage())})},queryFriendMessage:function(e){var n=this;A.a.queryFriendMessage({userId:this.userId,friendUserId:this.friendInfo.userId,page:this.page}).then(function(t){if(200===t.statusCode){if(e){var o;(o=n.messageRecords).unshift.apply(o,a()(t.result.rows.reverse()))}else n.messageRecords=n.messageRecords.concat(t.result.rows.reverse());n.messageRecords.length<t.result.count&&(n.isLoading=!1)}})},onRefresh:function(){this.page++,this.queryFriendMessage(!0)},sendMessage:function(e){var n=this;A.a.sendFriendMessage({userId:this.userId,friendUserId:this.friendInfo.userId,contentText:e}).then(function(e){200===e.statusCode&&(n.messageRecords.push(e.result),console.log("发送消息成功",e),n.changeChatStatus())})},changeChatStatus:function(){var e=this;this.setChatStatusFlag&&A.a.setInchatStatus({userId:this.userId,friendUserId:this.friendInfo.userId,status:1}).then(function(n){e.setChatStatusFlag=!1,200===n.statusCode&&console.log("发送消息成功",n)})},backMessageList:function(){this.$router.push({name:"MessageIndex"})}}}},357:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"FooterChatInput",data:function(){return{messageText:"",sendLock:!1}},computed:{activeIndex:function(){var e=this.$route.path.match(/\/(.*)\//)[1];return"message"===e?1:"contacts"===e?2:"user"===e?3:""}},methods:{sendMessage:function(e){var n=this;this.sendLock||(this.sendLock=!0,this.$emit("sendMessage",this.messageText),this.messageText=""),setTimeout(function(){n.sendLock=!1},1e3)}}}},359:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var o="";o="ws://47.98.128.245:8040"},361:function(e,n,t){n=e.exports=t(320)(!0),n.push([e.i,'.chat-message-list[data-v-28c4c958],.pages[data-v-28c4c958]{width:100%;height:100%;background-color:#f0f0f0}.chat-message-list[data-v-28c4c958]{-webkit-box-sizing:border-box;box-sizing:border-box;padding-top:.88rem;padding-bottom:2.08rem;overflow:auto}.chat-message-list li[data-v-28c4c958]{padding:10px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}.chat-message-list li img[data-v-28c4c958]{width:.8rem;height:.8rem;float:right;border-radius:50%}.chat-message-list li p[data-v-28c4c958]{float:right;margin-top:5px;margin-right:10px;border:1px solid #1989fa;background-color:#fff;padding:4px 8px;border-radius:4px;max-width:70%;position:relative}.chat-message-list li p[data-v-28c4c958]:after{content:"";width:8px;height:8px;border:1px solid #1989fa;border-bottom:0;border-left:0;position:absolute;top:22%;right:-5px;background-color:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.chat-message-list li.left img[data-v-28c4c958]{float:left}.chat-message-list li.left p[data-v-28c4c958]{float:left;margin-right:0;margin-left:10px}.chat-message-list li.left p[data-v-28c4c958]:after{border:1px solid #1989fa;border-top:0;border-right:0;top:22%;left:-5px}',"",{version:3,sources:["/Users/kaolaqilee/Documents/projectDemo/alittleQQ/src/component/app/message/chat/index.vue"],names:[],mappings:"AAMA,4DAJE,WAAY,AACZ,YAAa,AACb,wBAA0B,CAW3B,AATD,oCAGE,8BAA+B,AACvB,sBAAuB,AAC/B,mBAAqB,AACrB,uBAAwB,AACxB,aAAe,CAEhB,AACD,uCACI,aAAmB,AACnB,WAAY,AACZ,8BAA+B,AACvB,sBAAuB,AAC/B,eAAiB,CACpB,AACD,2CACM,YAAc,AACd,aAAe,AACf,YAAa,AACb,iBAAmB,CACxB,AACD,yCACM,YAAa,AACb,eAAgB,AAChB,kBAAmB,AACnB,yBAA0B,AAC1B,sBAAuB,AACvB,gBAAiB,AACjB,kBAAmB,AACnB,cAAe,AACf,iBAAmB,CACxB,AACD,+CACQ,WAAY,AACZ,UAAW,AACX,WAAY,AACZ,yBAA0B,AAC1B,gBAAiB,AACjB,cAAe,AACf,kBAAmB,AACnB,QAAS,AACT,WAAY,AACZ,sBAAuB,AACvB,gCAAiC,AACzB,uBAAyB,CACxC,AACD,gDACM,UAAY,CACjB,AACD,8CACM,WAAY,AACZ,eAAgB,AAChB,gBAAkB,CACvB,AACD,oDACQ,yBAA0B,AAC1B,aAAc,AACd,eAAgB,AAChB,QAAS,AACT,SAAW,CAClB",file:"index.vue",sourcesContent:["\n.pages[data-v-28c4c958] {\n  width: 100%;\n  height: 100%;\n  background-color: #f0f0f0;\n}\n.chat-message-list[data-v-28c4c958] {\n  width: 100%;\n  height: 100%;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  padding-top: 0.88rem;\n  padding-bottom: 2.08rem;\n  overflow: auto;\n  background-color: #f0f0f0;\n}\n.chat-message-list li[data-v-28c4c958] {\n    padding: 10px 10px;\n    width: 100%;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    overflow: hidden;\n}\n.chat-message-list li img[data-v-28c4c958] {\n      width: 0.8rem;\n      height: 0.8rem;\n      float: right;\n      border-radius: 50%;\n}\n.chat-message-list li p[data-v-28c4c958] {\n      float: right;\n      margin-top: 5px;\n      margin-right: 10px;\n      border: 1px solid #1989fa;\n      background-color: #fff;\n      padding: 4px 8px;\n      border-radius: 4px;\n      max-width: 70%;\n      position: relative;\n}\n.chat-message-list li p[data-v-28c4c958]::after {\n        content: '';\n        width: 8px;\n        height: 8px;\n        border: 1px solid #1989fa;\n        border-bottom: 0;\n        border-left: 0;\n        position: absolute;\n        top: 22%;\n        right: -5px;\n        background-color: #fff;\n        -webkit-transform: rotate(45deg);\n                transform: rotate(45deg);\n}\n.chat-message-list li.left img[data-v-28c4c958] {\n      float: left;\n}\n.chat-message-list li.left p[data-v-28c4c958] {\n      float: left;\n      margin-right: 0;\n      margin-left: 10px;\n}\n.chat-message-list li.left p[data-v-28c4c958]::after {\n        border: 1px solid #1989fa;\n        border-top: 0;\n        border-right: 0;\n        top: 22%;\n        left: -5px;\n}\n"],sourceRoot:""}])},366:function(e,n,t){n=e.exports=t(320)(!0),n.push([e.i,".footer-input-container[data-v-49b6db19]{position:fixed;left:0;right:0;bottom:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom);overflow:hidden;background-color:#f0f0f0}.footer-input-container .box[data-v-49b6db19]{padding:.2rem;position:relative}.footer-input-container .box textarea[data-v-49b6db19]{border:1px solid #f0f0f0;border-radius:.32rem;-webkit-box-sizing:border-box;box-sizing:border-box;line-height:.32rem;padding:10px;width:6.1rem;height:.64rem;margin-right:.2rem;resize:none;font-size:.28rem;vertical-align:middle}.footer-input-container .box button[data-v-49b6db19]{vertical-align:middle;position:absolute;right:.2rem;bottom:.2rem;border:none;outline:none;width:1rem;border-radius:.1rem;padding:0 .12rem;line-height:.62rem;font-size:.24rem;background-color:#dadada;pointer-events:none}.footer-input-container .box button.active[data-v-49b6db19]{background-color:#65a1de;pointer-events:auto}","",{version:3,sources:["/Users/kaolaqilee/Documents/projectDemo/alittleQQ/src/component/common/footerChatInput/index.vue"],names:[],mappings:"AACA,yCACE,eAAgB,AAChB,OAAU,AACV,QAAW,AACX,SAAY,AACZ,8BAA+B,AACvB,sBAAuB,AAC/B,gDAAiD,AACjD,2CAA4C,AAC5C,gBAAiB,AACjB,wBAA0B,CAC3B,AACD,8CACI,cAAgB,AAChB,iBAAmB,CACtB,AACD,uDACM,yBAA0B,AAC1B,qBAAuB,AACvB,8BAA+B,AACvB,sBAAuB,AAC/B,mBAAqB,AACrB,aAAmB,AACnB,aAAc,AACd,cAAgB,AAChB,mBAAqB,AACrB,YAAa,AACb,iBAAmB,AACnB,qBAAuB,CAC5B,AACD,qDACM,sBAAuB,AACvB,kBAAmB,AACnB,YAAc,AACd,aAAe,AACf,YAAa,AACb,aAAc,AACd,WAAY,AACZ,oBAAsB,AACtB,iBAAmB,AACnB,mBAAqB,AACrB,iBAAmB,AACnB,yBAA0B,AAC1B,mBAAqB,CAC1B,AACD,4DACQ,yBAA0B,AAC1B,mBAAqB,CAC5B",file:"index.vue",sourcesContent:["\n.footer-input-container[data-v-49b6db19] {\n  position: fixed;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  padding-bottom: constant(safe-area-inset-bottom);\n  padding-bottom: env(safe-area-inset-bottom);\n  overflow: hidden;\n  background-color: #f0f0f0;\n}\n.footer-input-container .box[data-v-49b6db19] {\n    padding: 0.2rem;\n    position: relative;\n}\n.footer-input-container .box textarea[data-v-49b6db19] {\n      border: 1px solid #f0f0f0;\n      border-radius: 0.32rem;\n      -webkit-box-sizing: border-box;\n              box-sizing: border-box;\n      line-height: 0.32rem;\n      padding: 10px 10px;\n      width: 6.1rem;\n      height: 0.64rem;\n      margin-right: 0.2rem;\n      resize: none;\n      font-size: 0.28rem;\n      vertical-align: middle;\n}\n.footer-input-container .box button[data-v-49b6db19] {\n      vertical-align: middle;\n      position: absolute;\n      right: 0.2rem;\n      bottom: 0.2rem;\n      border: none;\n      outline: none;\n      width: 1rem;\n      border-radius: 0.1rem;\n      padding: 0 0.12rem;\n      line-height: 0.62rem;\n      font-size: 0.24rem;\n      background-color: #dadada;\n      pointer-events: none;\n}\n.footer-input-container .box button.active[data-v-49b6db19] {\n        background-color: #65a1de;\n        pointer-events: auto;\n}\n"],sourceRoot:""}])},372:function(e,n,t){var o=t(361);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(321)("3eb45239",o,!0)},377:function(e,n,t){var o=t(366);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(321)("11a563b4",o,!0)},382:function(e,n,t){function o(e){t(377)}var a=t(17)(t(357),t(390),o,"data-v-49b6db19",null);e.exports=a.exports},385:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"pages"},[t("nav-head",{attrs:{"is-back":!0,"ong-history-back":e.backMessageList,title:e.friendInfo.nickname,icon:"other-pay"}}),e._v(" "),t("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(n){e.isLoading=n},expression:"isLoading"}},[t("ul",{ref:"messageList",staticClass:"chat-message-list"},[e._l(e.messageRecords,function(n,o){return[n.userId===e.userId?t("li",{key:o},[t("img",{attrs:{src:e.avatar,alt:""}}),e._v(" "),t("p",[e._v(e._s(n.contentText))])]):t("li",{key:o,staticClass:"left"},[t("img",{attrs:{src:e.friendInfo.avatar,alt:""}}),e._v(" "),t("p",[e._v(e._s(n.contentText))])])]})],2)]),e._v(" "),t("footer-chat-input",{on:{sendMessage:e.sendMessage}})],1)},staticRenderFns:[]}},390:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"footer-input-container"},[t("div",{staticClass:"box"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],domProps:{value:e.messageText},on:{input:function(n){n.target.composing||(e.messageText=n.target.value)}}}),e._v(" "),t("button",{class:{active:e.messageText},on:{click:e.sendMessage}},[e._v("发送")])])])},staticRenderFns:[]}}});
//# sourceMappingURL=0.e4e153d33632fd04c844.js.map